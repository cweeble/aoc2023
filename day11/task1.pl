#!/usr/bin/perl
use strict;
my @row;
my @col;
my $row = 0;
my $col;
my @galaxies;
while (my $line = <DATA>) {
    next if ($line =~ /01234/);
    $line =~ s/[0-9]//;
    chomp $line;
    my @line = split(//, $line);
    $col = 0;
    $row[$row] = $line =~ /#/ ? 1 : 2;
    for my $map (@line) {
        $col[$col] = 2 if (!$row);
        if ($map eq '#') {
            $col[$col] = 1;
            push(@galaxies, join(':', $col, $row));
        }
        $col++;
    }
    $row++;
}

my $total;
for (my $gxy = 0; $gxy<@galaxies-1; $gxy++) {
    my ($gxyX, $gxyY) = split(/:/, $galaxies[$gxy]);
    my $distance;
    for (my $i = $gxy+1; $i<@galaxies; $i++) {
        $distance = -2;
        my ($x, $y) = split(/:/, $galaxies[$i]);
        my @x = sort { $a<=>$b } ($gxyX, $x);
        my @y = sort { $a<=>$b } ($gxyY, $y);
        $distance++ if ($gxyX == $x);
        $distance++ if ($gxyY == $y);
        printf("\n(%s) to (%s):", $galaxies[$gxy], $galaxies[$i]);
        print $col[$_] and $distance += $col[$_] for ($x[0] .. $x[1]);
        print ':';
        print $row[$_] and $distance += $row[$_] for ($y[0] .. $y[1]);
        printf(" = %d\n", $distance);
        $total += $distance;
    }
}
print "$total\n";
__DATA__
........................................#........#.............#............#.........#................................................#....
....#.............................................................................................................................#.........
....................#...................................#......................................#.........................#..................
............................................................................................................................................
#..........#.....................#...............................................................................#..........................
......................................................................................................#.....................#...............
........................#..................................#.............................#..................................................
............................................#.........................#..........#............#.........................#...............#...
...#..........................#.......................#......................................................#..............................
............#...............................................................................................................................
..................................................................................................#.........................................
.........................#..................................................#...............................................................
.....................................#..............................................#..................#...................#................
...............................................#.......................#....................................#...............................
..#...............................................................#...............................................................#.........
..................#.............................................................#.........#........................#........................
.......................................#..............#......#..............................................................................
.............................#........................................................#.........#.............................#.............
...................................#....................................................................#................#...............#..
...#........................................#...............................................................................................
........................................................................#..................#................................................
...........#........................................................................#...............................#.......#...............
................#...........................................#..............................................#................................
............................................................................................................................................
......................#.......#.........#.........#................#...................................#..............................#.....
.........#....................................................................#.............................................................
..................................#..........#............#..............#..................#......#........................................
............................................................................................................................................
...................................................................................#..............................#.............#...........
#..........................#........................#...........................................#...........................................
............................................................................................................................................
.....#.......#......#.........................................#.......#.................#...............#..................#................
..............................................................................#.............................................................
.........#.............................#............................................................#.......................................
.....................................................#.......................................#.................#............................
......................#...........................................#..................................................#..................#...
..............#..........................................#.........................#........................................#...............
..........................#.....................#................................................................................#..........
..........................................................................................................#................................#
.......................................#............#...................................#...................................................
#...............#............................................#....................................................#.........................
............................#..................................................................................................#............
............#.........#.................................#.....................#.............................................................
......................................................................................................#.....................................
...#......................................#.........................#.......................................#..............#......#.....#...
..............................................................................................#.............................................
................#.............#.....................#...........................#...........................................................
............................................................................................................................................
.#......#.......................................#...........................................................................................
.............#..........................#........................#..........#....................#..........................................
............................................................................................................................................
............................................................................................................................................
..........................#........#.................................................................#.........................#............
...#.......#..................................................#......................................................................#......
................#...........................................................................................................................
..........................................#............#.......................................................#............#.............#.
............................................................................................................................................
...................#........#....................#...................................#.............................#........................
............................................................................................................................................
............................................................................................................................................
..............#.........#............................#.............#..............#....................#....................................
......................................#.....#............................................................................................#..
......#...........#...........#.........................................#........................#..........................................
.............................................................................................................#........#.....................
..............................................................#...............................................................#.............
..................................#..............#......................................#...................................................
............................................................................................................................................
.............#..............................#..................................................#............................................
...#.................#.................................................#..............................#.....................................
............................................................................................................................................
............................#..........#................#.......................#.................#..........#..............................
...............................................#..................................................................................#.........
..........#........................#........................................................................................................
......................#................................................................................#....................................
#............................................................................................#..........................#................#..
.................#..............#.......#..........#.........................#..................................#...........................
..................................................................#.....#........................#...............................#..........
.........#....................................#............................................................#..........................#.....
..#.........................................................................................................................................
............................................................................................................................................
....................#........................................#.......................#......................................................
.............................#.............................................................#.........#............#.........#.......#.......
..........................................#............#....................................................................................
............................................................................................................................................
.#...............#....................................................#..........#.............................................#............
............#......................................#.....................................#........#.................#.......................
......#.................#........#.....................................................................#...................#................
........................................#......#...............................................................#.......................#....
............................................................................................................................................
..................................................................#.....#...................................................................
.............#............................................................................................#...............................#.
............................................................................................................................................
............................#........................................................................................#.........#............
......................................................#.....................#.................#.............................................
.......................................#................................................#...................................................
............................................#...............................................................................................
.#..............#..................#..............#.............#..............................................#.....................#......
..........................................................#............#...................................................#................
........................#........................................................#..........................................................
....#..............................................................#........#.........#.....................................................
............................#...................................................................#...........................................
........................................#....................................................................#..........#...................
................................#............#..............................................#...............................................
..#......................................................#......#.................................................#...................#.....
...................#...................................................................................#....................................
.............#....................................#..........................................................................#.............#
........#.................................................................#.....#...............#...........................................
..........................................#............#..................................#...............#.................................
......................................................................................................................#.....................
.................................#...................................................#..............................................#.......
.................................................#..........#...............#..............................................#................
#.....#.................#...........................................#.............................#.............#...........................
.................#..........................................................................................................................
........................................................................#.....................#........#.................................#..
..........#...................#..........................#........................................................................#.........
....................................#...........................#.........................................................#.................
..........................#..................#.....................................#........................................................
.....#................................................#..............................................#........#.............................
.............#......................................................#................................................................#......
....................#............#..............#...............................#...............#.........................................#.
...........................................................................................#..............#......#..........................
#..........................................................#................#.........................................#.....................
.........................................#..................................................................................................
......................#..............................#..................................................................................#...
...#..........#....................#..........#...................................#...............................................#.........
.........................................................#..............#...................................................#...............
............................#....................................#.................................#...............#........................
........................................................................................................................#...................
.#...................#......................................................#............#...........................................#.....#
............#.....................................#.........#.........#.....................................................................
.............................................................................................#................#.............................
.................................#.........#............#.......................................................................#...........
...............#.......#.................................................................................#..................................
.................................................................#.......................................................#..........#.......
............................................................................................................................................
............#.....#.........#...............................#..............................#......#..........#..............................
.......................................................#............................#.......................................................
................................#..................................#...................................................#....................
............................................#......#......................#..........................................................#......
.#..............................................................................................#..................#........................